<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ARA Feet ↔ Meters Converter</title>
  <style>
    :root { --radius: 12px; --dark:#111; --light:#f2f2f2; }
    .card, .card * { box-sizing: border-box; }

    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 24px; }
    .card { max-width: 640px; margin: 0 auto; padding: 20px; border: 1px solid #ddd; border-radius: var(--radius); }
    h1 { margin: 0 0 10px; font-size: 1.6rem; }
    .sub { margin: 0 0 16px; color: #555; }
    .note { width: 100%; background: #f7f7f7; padding: 10px 12px; border-radius: var(--radius); border: 1px solid #e7e7e7; margin-bottom: 16px; }

    label { display:block; margin: 12px 0 6px; font-weight:600; }
    input[type="number"] {
      width: 100%; display: block; padding: 10px;
      border: 1px solid #ccc; border-radius: 8px; font-size: 1rem;
    }
    /* Red outline for invalid/empty when user tries to copy */
    input.error {
      border-color: #e11900;
      box-shadow: 0 0 0 3px rgba(225, 25, 0, 0.15);
      outline: none;
    }

    .btn-row { display:flex; gap:10px; flex-wrap:wrap; margin-top: 14px; }
    button { padding:10px 14px; border:0; border-radius:8px; cursor:pointer; }
    .btn-primary { background: var(--dark); color:#fff; }
    .btn-secondary { background:#e9e9e9; color:#111; }
    button[disabled]{ opacity:.6; cursor:not-allowed; }

    .foot { margin-top:18px; font-size:.9rem; color:#666; line-height:1.35; }
    form { margin: 0; }
  </style>
</head>
<body>
  <div class="card">
    <h1>ARA Feet ↔ Meters Converter</h1>
    <p class="sub">Ancient Roots Alberta</p>

    <div class="note">
      Enter a value in either field below — the other updates automatically. Values are shown to <strong>2 decimals</strong>.
    </div>

    <form id="conv-form" action="#">
      <label for="feet">Feet (ft)</label>
      <input id="feet" type="number" step="0.01" inputmode="decimal" placeholder="e.g. 12.00" />

      <label for="meters">Meters (m)</label>
      <input id="meters" type="number" step="0.01" inputmode="decimal" placeholder="e.g. 3.66" />

      <div class="btn-row">
        <button type="button" id="copy-m" class="btn-secondary" title="Copy meters value only" disabled>Copy meters (m)</button>
        <button type="button" id="copy-ft" class="btn-secondary" title="Copy feet value only" disabled>Copy feet (ft)</button>
        <button type="reset"  id="reset" class="btn-secondary">Reset</button>
        <button type="submit" class="btn-primary" title="Formats both fields to 2 decimals">Apply formatting (Enter)</button>
      </div>
    </form>

    <div class="foot">
      <strong>ARA nomination form note:</strong> ARA accepts values in <strong>meters only</strong>.
      for tree nomination. Enter <strong>pure numbers</strong> (no units or letters) — e.g., <code>4.34</code>, not <code>4.34 m</code>.
    </div>
  </div>

  <script>
    const FT_PER_M = 3.28084, M_PER_FT = 0.3048;
    const $ = (s) => document.querySelector(s);

    const form = $('#conv-form');
    const feet = $('#feet');
    const meters = $('#meters');
    const copyM = $('#copy-m');
    const copyFT = $('#copy-ft');

    // Update opposite field to two decimals (without reformatting what user is typing)
    feet.addEventListener('input', () => {
      clearError(feet);
      const v = parseFloat(feet.value);
      if (Number.isNaN(v)) {
        meters.value = '';
        setCopyState();
        return;
      }
      meters.value = (v * M_PER_FT).toFixed(2);
      setCopyState();
    });

    meters.addEventListener('input', () => {
      clearError(meters);
      const v = parseFloat(meters.value);
      if (Number.isNaN(v)) {
        feet.value = '';
        setCopyState();
        return;
      }
      feet.value = (v * FT_PER_M).toFixed(2);
      setCopyState();
    });

    // On blur, format the edited field to exactly 2 decimals (if it has a number)
    [feet, meters].forEach(inp => {
      inp.addEventListener('blur', () => {
        const v = parseFloat(inp.value);
        if (!Number.isNaN(v)) inp.value = v.toFixed(2);
        setCopyState();
      });
      inp.addEventListener('keydown', (e) => {
        // Enter formats both fields
        if (e.key === 'Enter') {
          e.preventDefault();
          applyFormatting();
        }
      });
    });

    // Form submit (or Enter anywhere): format both fields cleanly to 2 decimals
    form.addEventListener('submit', (e) => {
      e.preventDefault();
      applyFormatting();
    });

    // Reset clears everything and disables copy buttons
    form.addEventListener('reset', () => {
      setTimeout(() => {
        clearError(feet); clearError(meters);
        feet.value = ''; meters.value = '';
        setCopyState();
      }, 0);
    });

    // Copy helpers
    copyM.addEventListener('click', () => copyValue(meters, copyM, 'Copy meters (m)'));
    copyFT.addEventListener('click', () => copyValue(feet, copyFT, 'Copy feet (ft)'));

    function applyFormatting(){
      format2(feet);
      format2(meters);
      setCopyState();
    }
    function format2(inp){
      const v = parseFloat(inp.value);
      if (!Number.isNaN(v)) inp.value = v.toFixed(2);
    }

    function setCopyState(){
      const hasM = meters.value.trim() !== '' && !Number.isNaN(parseFloat(meters.value));
      const hasF = feet.value.trim()   !== '' && !Number.isNaN(parseFloat(feet.value));
      copyM.disabled = !hasM;
      copyFT.disabled = !hasF;
    }

    async function copyValue(inp, btn, label){
      const v = inp.value.trim();
      if (v === '') { markError(inp); return; }
      try {
        await navigator.clipboard.writeText(v);
        btn.textContent = 'Copied ✓';
        setTimeout(() => { btn.textContent = label; }, 1200);
      } catch {
        // fallback
        const tmp = document.createElement('input');
        tmp.value = v; document.body.appendChild(tmp);
        tmp.select(); document.execCommand('copy');
        document.body.removeChild(tmp);
        btn.textContent = 'Copied ✓';
        setTimeout(() => { btn.textContent = label; }, 1200);
      }
    }

    function markError(inp){
      inp.classList.add('error');
      inp.focus();
    }
    function clearError(inp){
      inp.classList.remove('error');
    }
  </script>
</body>
</html>
