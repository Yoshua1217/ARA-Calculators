<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ARA Tree Height Calculator</title>
  <style>
    :root { --radius: 12px; }
    .card, .card * { box-sizing: border-box; }

    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 24px; }
    .card { max-width: 640px; margin: 0 auto; padding: 20px; border: 1px solid #ddd; border-radius: var(--radius); }
    h1 { margin: 0 0 10px; font-size: 1.6rem; }
    .sub { margin: 0 0 16px; color: #555; }
    .note { width: 100%; background: #f7f7f7; padding: 10px 12px; border-radius: var(--radius); border: 1px solid #e7e7e7; margin-bottom: 16px; }

    label { display:block; margin: 12px 0 6px; font-weight:600; }
    input[type="number"] {
      width: 100%;
      display: block;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 1rem;
    }
    /* Red outline when invalid (after a submit attempt) */
    input.error {
      border-color: #e11900;
      box-shadow: 0 0 0 3px rgba(225, 25, 0, 0.15);
      outline: none;
    }

    button { margin-top:14px; padding:10px 14px; border:0; border-radius:8px; cursor:pointer; }
    .btn { background:#111; color:#fff; }
    .result { margin-top:16px; font-size:1.2rem; font-weight:700; }
    .foot { margin-top:18px; font-size:.9rem; color:#666; line-height:1.35; }
    form { margin: 0; }
  </style>
</head>
<body>
  <div class="card">
    <h1>ARA Tree Height Calculator</h1>
    <p class="sub">Ancient Roots Alberta</p>

    <div class="note"><strong>Manual formula:</strong> height = tan(angle°) × distance + eye height.
    You don’t need to do this by hand—this calculator applies it automatically.</div>

    <form id="calc-form" action="#">
      <label for="angle">Angle to top (degrees)</label>
      <input id="angle" type="number" step="0.1" inputmode="decimal" placeholder="e.g. 37.5" required />

      <label for="distance">Distance to trunk (meters)</label>
      <input id="distance" type="number" step="0.01" inputmode="decimal" placeholder="e.g. 23.4" required />

      <label for="eye">Eye height (meters)</label>
      <input id="eye" type="number" step="0.01" inputmode="decimal" placeholder="e.g. 1.62" required />

      <button type="submit" class="btn">Calculate height</button>
    </form>

    <div class="result" id="out" aria-live="polite">—</div>

    <div class="foot">
      Outputs in meters and feet. Angle must be in degrees.<br>
      <strong>ARA nomination form note:</strong> ARA accepts values in <strong>meters only</strong>.
      Enter <strong>pure numbers</strong> (no units or letters) — e.g., <code>4.34</code>, not <code>4.34 m</code>.
    </div>
  </div>

  <script>
    function tanDeg(d){ return Math.tan(d * Math.PI / 180); }

    function calculate(e){
      e.preventDefault(); // stop page refresh
      const form = document.getElementById('calc-form');
      if (!form.checkValidity()) {
        // Let the browser show its native popup, and mark invalid inputs red
        markInvalids();
        return;
      }
      clearErrors();

      const a  = parseFloat(document.getElementById('angle').value);
      const d  = parseFloat(document.getElementById('distance').value);
      const eH = parseFloat(document.getElementById('eye').value);

      const h = tanDeg(a) * d + eH;
      const feet = h * 3.28084;
      document.getElementById('out').textContent =
        `Height ≈ ${h.toFixed(2)} m (${feet.toFixed(1)} ft)`;
    }

    // Add red outline when the browser flags a field as invalid
    function markInvalids(){
      document.querySelectorAll('#calc-form input').forEach(inp => {
        if (!inp.validity.valid) inp.classList.add('error');
      });
    }
    // Remove red outline for fields that become valid
    function clearErrors(){
      document.querySelectorAll('#calc-form input.error').forEach(inp => {
        if (inp.validity.valid) inp.classList.remove('error');
      });
    }

    // Live cleanup as the user types
    document.querySelectorAll('#calc-form input').forEach(inp => {
      inp.addEventListener('input', () => {
        if (inp.validity.valid) inp.classList.remove('error');
      });
      // Also catch the moment a field fails validation on submit
      inp.addEventListener('invalid', () => inp.classList.add('error'));
    });

    document.getElementById('calc-form').addEventListener('submit', calculate);
  </script>
</body>
</html>
